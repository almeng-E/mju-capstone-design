import pandas as pd

# 데이터 프레임 생성 예시
df = pd.read_csv('최종 파일들/tagged_final.csv')

# 소분류 -> 대분류 매핑 사전 설정
tag_mapping = {
    "대학 역사": "대학 정보",
    "대학 사업": "대학 정보",
    "캠퍼스 투어": "대학 정보",
    
    "전공 탐구 및 소개": "학과 및 전공 정보",
    "커리큘럼 설명": "학과 및 전공 정보",
    "대학원 소개": "학과 및 전공 정보",
    
    "입학 전형 안내": "입학 및 입시",
    "입시 관련 팁": "입학 및 입시",
    "신입생 정보": "입학 및 입시",
    
    "학생 생활 전반": "학생 생활",
    "기숙사 소개": "학생 생활",
    "학식 소개": "학생 생활",
    "동아리/학회": "학생 생활",
    "학생 복지 서비스": "학생 생활",
    "선배 멘토링": "학생 생활",
    
    "수강 신청": "수업 및 학습 지원",
    "학습 노하우": "수업 및 학습 지원",
    "연구 프로젝트": "수업 및 학습 지원",
    "학술 대회": "수업 및 학습 지원",
    "연구 성과 및 논문 발표": "수업 및 학습 지원",
    
    "교환학생 프로그램": "국제 교류",
    "국제 교류 프로그램": "국제 교류",
    
    "취업 설명회 및 박람회": "진로 및 취업 지원",
    "진로 지원": "진로 및 취업 지원",
    "기업 연계 프로그램": "진로 및 취업 지원",
    
    "장학금 안내": "장학금 및 재정 지원",
    
    "축제": "학교 행사",
    "체전": "학교 행사",
    "이벤트": "학교 행사",
    "입학식": "학교 행사",
    "졸업식": "학교 행사",
    
    "학생 인터뷰": "인터뷰 및 강연",
    "동문 인터뷰": "인터뷰 및 강연",
    "교수 인터뷰": "인터뷰 및 강연",
    "교수 강연": "인터뷰 및 강연",
    
    "기타 자체 콘텐츠": "기타",
    "브이로그": "기타",
    "학교 홍보대사": "기타",
}

def convert_tags(tags):
    if pd.isna(tags):
        return ""
    sub_tags = tags.split('+')
    main_tags = set(tag_mapping.get(tag.strip(), tag.strip()) for tag in sub_tags)
    return '+'.join(main_tags)

# NaN 값을 빈 문자열로 대체
df['tags'] = df['tags'].fillna('')

# 태그를 대분류로 변환
df['tags'] = df['tags'].apply(convert_tags)

# 변환된 CSV 파일 저장 (UTF-8 인코딩)
df.to_csv('tagged_final_classified.csv', index=False, encoding='utf-8')
